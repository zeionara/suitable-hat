Это настолько хуево, что даже не переделать.
