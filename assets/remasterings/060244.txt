мап-редюсом ёбнуть и всё в те же 18 строчек анекдот влезет
